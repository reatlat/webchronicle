(()=>{var a=(...e)=>{(location.hostname.match("local")||window.sessionStorage.unicorn)&&console.log("\u{1F984}:",...e)};document.addEventListener("alpine:init",()=>{Alpine.data("llmstxtGenerator",()=>({currentStep:1,inputMethod:"sitemap",step1DataChanged:!1,step2DataChanged:!1,sitemapUrl:"",initialSitemapUrl:"",customHints:{corePattern:"",productPattern:"",docsPattern:"",resourcesPattern:"",supportPattern:"",blogPattern:"",companyPattern:"",legalPattern:""},useDefaultExclusions:!0,excludePatterns:"",manualUrls:"",initialManualUrls:"",parseResults:null,totalUrls:0,excludedUrls:0,filteredUrls:0,includedUrls:0,limitApplied:!1,sitemapsProcessed:0,exclusionStats:null,categorizedUrls:{core:[],product:[],docs:[],resources:[],support:[],blog:[],company:[],legal:[],other:[]},analyzedPages:{core:[],product:[],docs:[],resources:[],support:[],blog:[],company:[],legal:[],other:[]},processedCount:0,failedCount:0,errors:[],detectedSite:{name:"",url:"",suffix:"",description:""},selectedPages:[],siteName:"",siteUrl:"",siteSuffix:"",siteDescription:"",generatedLlmsTxt:"",stats:null,isLoading:!1,loadingMessage:"",loadingMessageIndex:0,loadingInterval:null,errorMessage:"",successMessage:"",loadingMessages:["Squeezing fresh content from your pages...","Picking the ripest URLs from your sitemap...","Blending your page titles into something smooth...","Extracting the juiciest metadata...","Peeling away unnecessary data...","Mixing up your content categories...","Pouring over your page descriptions...","Garnishing with SEO goodness...","Tasting your site's flavor profile...","Selecting the finest organic URLs...","Zesting your page titles for freshness...","Pulping through your sitemap...","Filtering out the seeds and stems...","Crafting your perfect content blend...","Chilling your data for optimal results...","Washing your URLs for peak freshness...","Slicing through duplicate content...","Juicing every last bit of metadata...","Inspecting fruit quality control...","Measuring perfect vitamin SEO levels...","Adding a splash of analytics...","Muddling your content ingredients...","Straining out low-quality pages...","Checking ripeness indicators...","Bottling up your best content...","Pressing organic page juice...","Stirring in fresh insights...","Blending smooth user experiences...","Infusing natural keywords...","Macerating metadata morsels...","Sweetening your descriptions...","Handpicking premium URLs...","Cold-pressing page content...","Testing pH levels of your copy...","Aerating your content mix...","Layering flavor profiles...","Reducing to perfection...","Caramelizing your headlines...","Simmering site structure...","Marinating metadata overnight...","Whisking up fresh categories...","Folding in smooth transitions...","Tempering your title tags...","Deglazing the content pan...","Basting your best pages..."],get isValidSitemapUrl(){if(!this.sitemapUrl)return!1;try{return new URL(this.sitemapUrl),!0}catch{return!1}},get manualUrlsArray(){return this.manualUrls.split(`
`).map(e=>e.trim()).filter(e=>e.length>0)},get isValidManualUrls(){let e=this.manualUrlsArray;return e.length>0&&e.length<=100},get canProceedToAnalysis(){return this.inputMethod==="sitemap"?this.parseResults!==null&&this.includedUrls>0:this.isValidManualUrls},get canGenerate(){return this.selectedPages.length>0},get totalSelectedPages(){return this.selectedPages.length},get canNavigateToStep2(){return this.processedCount>0},get canNavigateToStep3(){return this.generatedLlmsTxt!==""},startLoadingMessages(){this.loadingMessageIndex=Math.floor(Math.random()*this.loadingMessages.length),this.loadingMessage=this.loadingMessages[this.loadingMessageIndex],this.loadingInterval=setInterval(()=>{this.loadingMessageIndex=(this.loadingMessageIndex+1)%this.loadingMessages.length,this.loadingMessage=this.loadingMessages[this.loadingMessageIndex]},2500)},stopLoadingMessages(){this.loadingInterval&&(clearInterval(this.loadingInterval),this.loadingInterval=null),this.loadingMessage=""},navigateToStep(e){if(a("Attempting to navigate to step:",e),e===1){this.currentStep=1,this.errorMessage="",window.scrollTo({top:0,behavior:"smooth"});return}if(e>=2&&this.currentStep>=2){let s=this.inputMethod==="sitemap"&&this.sitemapUrl!==this.initialSitemapUrl,t=this.inputMethod==="manual"&&this.manualUrls!==this.initialManualUrls;if(s||t){this.errorMessage="Input data has changed. Please re-analyze before proceeding.",this.step1DataChanged=!0;return}}if(e===2){if(!this.canNavigateToStep2){this.inputMethod==="sitemap"&&!this.parseResults?this.errorMessage="Please parse your sitemap first, then analyze the URLs.":this.inputMethod==="sitemap"&&this.parseResults?this.errorMessage='Click "Analyze Selected URLs" to continue to the review step.':this.errorMessage='Click "Analyze URLs" to continue to the review step.';return}this.currentStep=2,this.errorMessage="",window.scrollTo({top:0,behavior:"smooth"});return}if(e===3){if(!this.canNavigateToStep3){this.errorMessage='Click "Generate llms.txt" to create your file first.';return}this.currentStep=3,this.errorMessage="",window.scrollTo({top:0,behavior:"smooth"});return}},async parseSitemap(){if(!this.isValidSitemapUrl){this.errorMessage="Please enter a valid sitemap URL";return}this.isLoading=!0,this.loadingMessage="Parsing sitemap...",this.errorMessage="",this.successMessage="",a("Parsing sitemap:",this.sitemapUrl);try{let e=this.getExcludePatternsArray(),s={sitemapUrl:this.sitemapUrl,hints:this.getActiveHints(),...this.useDefaultExclusions&&{useDefaultExclusions:!0},...e.length>0&&{excludePatterns:e}};a("Request body:",s);let t=await fetch("https://api.freshjuice.dev/llmstxt/parse-sitemap",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!t.ok){let r=await t.json();throw new Error(r.detail||"Failed to parse sitemap")}let i=await t.json();a("Parse result:",i),this.parseResults=i,this.totalUrls=i.totalUrls||0,this.excludedUrls=i.excludedUrls||0,this.filteredUrls=i.filteredUrls||0,this.includedUrls=i.includedUrls||0,this.limitApplied=i.limitApplied||!1,this.sitemapsProcessed=i.sitemapsProcessed||0,this.exclusionStats=i.exclusionStats||null,this.categorizedUrls={core:i.categories?.core||[],product:i.categories?.product||[],docs:i.categories?.docs||[],resources:i.categories?.resources||[],support:i.categories?.support||[],blog:i.categories?.blog||[],company:i.categories?.company||[],legal:i.categories?.legal||[],other:i.categories?.other||[]},this.successMessage=`Found ${this.totalUrls} URLs${this.limitApplied?" (limited to 100)":""}`,this.currentStep=2,this.initialSitemapUrl=this.sitemapUrl,this.step1DataChanged=!1}catch(e){a("Parse error:",e),this.errorMessage=e.message}finally{this.isLoading=!1,this.loadingMessage=""}},async analyzeUrls(e){this.isLoading=!0,this.errorMessage="",this.successMessage="",this.startLoadingMessages(),a("Analyzing URLs:",e);try{let s=await fetch("https://api.freshjuice.dev/llmstxt/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({urls:e,hints:this.getActiveHints()})});if(!s.ok){let i=await s.json();throw new Error(i.detail||"Failed to analyze URLs")}let t=await s.json();a("Analysis result:",t),this.analyzedPages={core:t.results?.core||[],product:t.results?.product||[],docs:t.results?.docs||[],resources:t.results?.resources||[],support:t.results?.support||[],blog:t.results?.blog||[],company:t.results?.company||[],legal:t.results?.legal||[],other:t.results?.other||[]},this.processedCount=t.processed,this.failedCount=t.failed,this.errors=t.errors||[],t.site&&(this.detectedSite={name:t.site.name||"",url:t.site.url||"",suffix:t.site.suffix||"",description:t.site.description||""},!this.siteName&&t.site.name&&(this.siteName=t.site.name),!this.siteUrl&&t.site.url&&(this.siteUrl=t.site.url),!this.siteSuffix&&t.site.suffix&&(this.siteSuffix=t.site.suffix),!this.siteDescription&&t.site.description&&(this.siteDescription=t.site.description),a("Detected site metadata:",this.detectedSite)),this.selectedPages=[...t.results.core||[],...t.results.product||[],...t.results.docs||[],...t.results.resources||[],...t.results.support||[],...t.results.blog||[],...t.results.company||[],...t.results.legal||[],...t.results.other||[]],this.successMessage=`Analyzed ${this.processedCount} pages successfully`,this.failedCount>0&&(this.errorMessage=`${this.failedCount} URLs failed to analyze`)}catch(s){a("Analysis error:",s),this.errorMessage=s.message}finally{this.isLoading=!1,this.stopLoadingMessages()}},async analyzeFromSitemap(){let e=[...this.categorizedUrls.core,...this.categorizedUrls.product,...this.categorizedUrls.docs,...this.categorizedUrls.resources,...this.categorizedUrls.support,...this.categorizedUrls.blog,...this.categorizedUrls.company,...this.categorizedUrls.legal,...this.categorizedUrls.other].map(s=>s.url);a("URLs to analyze from sitemap:",e.length),await this.analyzeUrls(e)},async analyzeFromManualUrls(){let e=this.manualUrlsArray;if(e.length===0||e.length>100){this.errorMessage="Please enter between 1 and 100 URLs";return}a("URLs to analyze (manual):",e.length),await this.analyzeUrls(e),this.currentStep=2,this.initialManualUrls=this.manualUrls,this.step1DataChanged=!1},async generateLlmsTxt(){if(this.selectedPages.length===0){this.errorMessage="Please select at least one page";return}this.isLoading=!0,this.loadingMessage="Generating llms.txt...",this.errorMessage="",this.successMessage="",a("Generating llms.txt with pages:",this.selectedPages.length);let e=this.getSuffixRegex(),s=this.selectedPages.map(t=>{if(e&&t.title){let i=t.title.replace(e,"").trim();if(i!==t.title)return{...t,title:i}}return t});try{let t=await fetch("https://api.freshjuice.dev/llmstxt/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({pages:s,siteName:this.siteName||void 0,siteUrl:this.siteUrl||void 0,siteDescription:this.siteDescription||void 0})});if(!t.ok){let r=await t.json();throw new Error(r.detail||"Failed to generate llms.txt")}let i=await t.json();a("Generation result:",i),this.generatedLlmsTxt=i.llmstxt,this.stats=i.stats,this.successMessage="llms.txt generated successfully!",this.currentStep=3,this.step2DataChanged=!1,window.scrollTo({top:0,behavior:"smooth"})}catch(t){a("Generation error:",t),this.errorMessage=t.message}finally{this.isLoading=!1,this.loadingMessage=""}},downloadLlmsTxt(){a("Downloading llms.txt");let e=new Blob([this.generatedLlmsTxt],{type:"text/plain"}),s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="llms.txt",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(s),this.successMessage="llms.txt downloaded successfully!",setTimeout(()=>{this.successMessage=""},3e3)},async copyToClipboard(){a("Copying to clipboard");try{await navigator.clipboard.writeText(this.generatedLlmsTxt),this.successMessage="Copied to clipboard!",setTimeout(()=>{this.successMessage=""},3e3)}catch(e){a("Clipboard error:",e);let s=document.createElement("textarea");s.value=this.generatedLlmsTxt,s.style.position="fixed",s.style.opacity="0",document.body.appendChild(s),s.select();try{document.execCommand("copy"),this.successMessage="Copied to clipboard!",setTimeout(()=>{this.successMessage=""},3e3)}catch{this.errorMessage="Failed to copy to clipboard"}document.body.removeChild(s)}},togglePageSelection(e){let s=this.selectedPages.findIndex(t=>t.url===e.url);s>-1?this.selectedPages.splice(s,1):this.selectedPages.push(e),a("Selected pages:",this.selectedPages.length)},isPageSelected(e){return this.selectedPages.some(s=>s.url===e.url)},getSuffixRegex(){if(!this.siteSuffix)return null;try{let e=this.siteSuffix;if(e.match(/^\s*\|/)&&(e=e.replace(/^(\s*)\|/,"$1\\|"),a("Auto-escaped leading pipe in suffix:",e)),/[\\^$.*+?()[\]{}|]/.test(e))return new RegExp(e+"$");{let t=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return new RegExp(t+"$")}}catch(e){return a("Invalid suffix regex:",e),null}},cleanPageTitle(e){if(!e||!this.siteSuffix)return e;let s=this.getSuffixRegex();return s?e.replace(s,"").trim():e},selectAllPages(){this.selectedPages=[...this.analyzedPages.core||[],...this.analyzedPages.product||[],...this.analyzedPages.docs||[],...this.analyzedPages.resources||[],...this.analyzedPages.support||[],...this.analyzedPages.blog||[],...this.analyzedPages.company||[],...this.analyzedPages.legal||[],...this.analyzedPages.other||[]],a("All pages selected:",this.selectedPages.length)},deselectAllPages(){this.selectedPages=[],a("All pages deselected")},selectCategoryPages(e){let s=this.analyzedPages[e]||[];s.forEach(t=>{this.isPageSelected(t)||this.selectedPages.push(t)}),a(`Selected all ${e} pages:`,s.length)},deselectCategoryPages(e){(this.analyzedPages[e]||[]).forEach(t=>{let i=this.selectedPages.findIndex(r=>r.url===t.url);i!==-1&&this.selectedPages.splice(i,1)}),a(`Deselected all ${e} pages`)},toggleCategoryPages(e){this.isCategoryFullySelected(e)?this.deselectCategoryPages(e):this.selectCategoryPages(e)},isCategoryFullySelected(e){let s=this.analyzedPages[e]||[];return s.length===0?!1:s.every(t=>this.isPageSelected(t))},getCategorySelectedCount(e){return(this.analyzedPages[e]||[]).filter(t=>this.isPageSelected(t)).length},getActiveHints(){let e={};return this.customHints.corePattern&&(e.corePattern=this.customHints.corePattern),this.customHints.productPattern&&(e.productPattern=this.customHints.productPattern),this.customHints.docsPattern&&(e.docsPattern=this.customHints.docsPattern),this.customHints.resourcesPattern&&(e.resourcesPattern=this.customHints.resourcesPattern),this.customHints.supportPattern&&(e.supportPattern=this.customHints.supportPattern),this.customHints.blogPattern&&(e.blogPattern=this.customHints.blogPattern),this.customHints.companyPattern&&(e.companyPattern=this.customHints.companyPattern),this.customHints.legalPattern&&(e.legalPattern=this.customHints.legalPattern),e},getExcludePatternsArray(){return this.excludePatterns?this.excludePatterns.split(`
`).map(e=>e.trim()).filter(e=>e.length>0):[]},reset(){a("Resetting generator"),this.currentStep=1,this.sitemapUrl="",this.initialSitemapUrl="",this.manualUrls="",this.initialManualUrls="",this.useDefaultExclusions=!0,this.excludePatterns="",this.step1DataChanged=!1,this.step2DataChanged=!1,this.parseResults=null,this.totalUrls=0,this.excludedUrls=0,this.filteredUrls=0,this.includedUrls=0,this.limitApplied=!1,this.sitemapsProcessed=0,this.exclusionStats=null,this.categorizedUrls={core:[],product:[],docs:[],resources:[],support:[],blog:[],company:[],legal:[],other:[]},this.analyzedPages={core:[],product:[],docs:[],resources:[],support:[],blog:[],company:[],legal:[],other:[]},this.processedCount=0,this.failedCount=0,this.errors=[],this.detectedSite={name:"",url:"",suffix:"",description:""},this.selectedPages=[],this.siteName="",this.siteUrl="",this.siteSuffix="",this.siteDescription="",this.generatedLlmsTxt="",this.stats=null,this.errorMessage="",this.successMessage="",window.scrollTo({top:0,behavior:"smooth"})},init(){a("llms.txt Generator initialized")}}))});})();
