(()=>{var a=(...t)=>{(location.hostname.match("local")||window.sessionStorage.unicorn)&&console.log("\u{1F984}:",...t)};function r(t){return String(t??"").replace(/<[^>]*>/g,"").replace(/\s+/g," ").trim()}function i(t){try{let e=new URL(String(t));if(e.protocol==="https:")return e.toString()}catch{}return""}document.addEventListener("alpine:init",()=>{Alpine.data("HeadingExtractor",()=>({targetUrl:"",buttonLabel:"Extract Headings",state:"idle",showResults:!1,errorMessage:"",headings:[],setButtonLabel(){switch(this.state){case"loading":this.buttonLabel="Extracting Headings...";break;case"success":this.buttonLabel="Extract Another URL";break;case"error":this.buttonLabel="Try Again";break;default:this.buttonLabel="Extract Headings"}},reset(){this.headings=[],this.showResults=!1,this.state="idle",this.errorMessage="",this.targetUrl="",this.setButtonLabel(),history.pushState({},"",location.pathname),this.$nextTick(()=>this.$refs?.targetUrl?.focus?.())},isValidUrl(t){t=r(t||"");let e=i(t);return!!e&&/^(https?:)\/\//i.test(e)},initProcessing(t){if(t&&typeof t.preventDefault=="function"&&t.preventDefault(),this.errorMessage="",!this.isValidUrl(this.targetUrl)){this.state="error",this.setButtonLabel(),this.errorMessage="Please enter a valid URL starting with http:// or https://";return}this.state="loading",this.setButtonLabel(),this.showResults=!1,this.headings=[],this.fetchHeadings()},async fetchHeadings(){let t=i(r(this.targetUrl));try{let e=await fetch("https://api.freshjuice.dev/heading-extractor",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({targetUrl:t})});if(a(`Heading extractor \u2192 ${e.status}`),!e.ok)throw new Error(`Request failed with status ${e.status}`);let s=await e.json();this.headings=Array.isArray(s?.headings)?s.headings:[],this.state="success",this.setButtonLabel(),this.showResults=!0,history.pushState({},"",`?url=${encodeURIComponent(t)}`)}catch(e){console.error(e),this.state="error",this.setButtonLabel(),this.errorMessage=e?.message||"Something went wrong. Please try again.",this.showResults=!1}},init(){a("Heading Extractor initialized");let e=new URLSearchParams(location.search).get("url");e&&(this.targetUrl=e,setTimeout(()=>this.initProcessing(),0))}}))});})();
