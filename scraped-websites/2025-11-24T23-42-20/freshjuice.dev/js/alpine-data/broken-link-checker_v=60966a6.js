(()=>{var i=(...t)=>{(location.hostname.match("local")||window.sessionStorage.unicorn)&&console.log("\u{1F984}:",...t)};function o(t){return String(t??"").replace(/<[^>]*>/g,"").replace(/\s+/g," ").trim()}function l(t){try{let s=new URL(String(t));if(s.protocol==="https:")return s.toString()}catch{}return""}document.addEventListener("alpine:init",()=>{Alpine.data("BrokenLinkChecker",()=>({urls:"",result:[],errorMessage:"",buttonLabel:"Check Links",openIndex:[],state:"idle",toggleOpen(t){this.openIndex=this.openIndex.includes(t)?this.openIndex.filter(s=>s!==t):[...this.openIndex,t]},checkUrl(t){return t=o(t),l(t)},setRefUTMs(t){let s=new URL(t),e=s.searchParams;return e.set("utm_source","freshjuice.dev"),e.set("utm_medium","tool"),e.set("utm_campaign","broken-link-checker"),s.search=e.toString(),s.toString()},async checkLinks(t){t.preventDefault(),this.result=[],this.errorMessage="";let s=this.urls.split(`
`).reduce((r,n)=>{let a=this.checkUrl(n);return a.trim()!==""&&r.push(a),r},[]);if(s.length===0){this.errorMessage="Please enter at least one URL.";return}i("Checking links"),this.result=s.map(r=>({url:r,status:"loading",data:{},totalBroken:0})),this.state="loading";let e=0;for(let r of s){try{let n=await fetch("https://api.freshjuice.dev/broken-link-checker",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({targetUrl:r})});if(i(`Checked ${r} - Status: ${n.status}`),n.status!==200)this.result[e]={url:r,status:"error",data:{},totalBroken:0};else{let a=await n.json();this.result[e]={url:r,status:"success",data:a,totalBroken:0}}}catch(n){this.state="error",this.errorMessage=n,this.result[e]={url:r,status:"error",data:{},totalBroken:-1}}this.result[e].status==="success"&&(this.result[e].totalBroken=Object.keys(this.result[e].data).reduce((n,a)=>400<=parseInt(a)&&parseInt(a)<500||parseInt(a)===999?n+this.result[e].data[a].length:n,0)),e++}this.state="success",setTimeout(()=>{this.state="idle"},2e3)},init(){i("Broken Link Checker initialized")}}))});})();
