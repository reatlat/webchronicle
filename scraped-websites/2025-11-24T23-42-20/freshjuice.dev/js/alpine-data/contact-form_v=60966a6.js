(()=>{var r=(...a)=>{(location.hostname.match("local")||window.sessionStorage.unicorn)&&console.log("\u{1F984}:",...a)};document.addEventListener("alpine:init",()=>{Alpine.data("ContactForm",a=>({API_ENDPOINT:"https://api.freshjuice.dev/contact",state:"idle",loading:!1,error:"",fields:{firstname:"",lastname:"",email:"",message:"",user_consent_mode:!1},meta:{pageUri:"",document_title:"",referrer:"",hutk:"",utm_campaign:"",utm_source:"",utm_medium:"",utm_term:"",utm_content:""},getCookie(t){let e=document.cookie.match(new RegExp("(^|;)\\s*"+t+"\\s*=\\s*([^;]+)"));return e?decodeURIComponent(e.pop()):""},reset(){this.state="idle",this.loading=!1,this.error="",this.fields={firstname:"",lastname:"",email:"",message:"",user_consent_mode:!1}},async submit(){this.loading=!0,this.error="";let t={form_type:a||"nada",firstname:this.fields.firstname,lastname:this.fields.lastname,email:this.fields.email,message:this.fields.message,user_consent_mode:this.fields.user_consent_mode,pageUri:this.meta.pageUri,document_title:this.meta.document_title,referrer:this.meta.referrer,hutk:this.meta.hutk,utm_campaign:this.meta.utm_campaign,utm_source:this.meta.utm_source,utm_medium:this.meta.utm_medium,utm_term:this.meta.utm_term,utm_content:this.meta.utm_content};try{let e=await fetch(this.API_ENDPOINT,{method:"POST",headers:{"content-type":"application/json; charset=utf-8"},body:JSON.stringify(t)});if(e.status===202)this.state="success",this.fields={firstname:"",lastname:"",email:"",message:"",user_consent_mode:!1};else{let s="Submission failed. Please try again.";try{let i=await e.json();s=i?.detail||i?.message||s}catch{let m=await e.text().catch(()=>"");m&&(s=m)}this.error=s,this.state="failed"}}catch{this.error="Network error. Please try again.",this.state="failed"}finally{this.loading=!1}},init(){r("Contact form initialized"),this.meta.pageUri=window.location.href,this.meta.document_title=document.title||"",this.meta.referrer=document.referrer||"",this.meta.hutk=this.getCookie("hubspotutk")||"";let t=new URL(window.location.href);this.meta.utm_campaign=t.searchParams.get("utm_campaign")||"",this.meta.utm_source=t.searchParams.get("utm_source")||"",this.meta.utm_medium=t.searchParams.get("utm_medium")||"",this.meta.utm_term=t.searchParams.get("utm_term")||"",this.meta.utm_content=t.searchParams.get("utm_content")||""}}))});})();
