(()=>{var a=(...t)=>{(location.hostname.match("local")||window.sessionStorage.unicorn)&&console.log("\u{1F984}:",...t)};function c(t){return String(t??"").replace(/<[^>]*>/g,"").replace(/\s+/g," ").trim()}function h(t){try{let e=new URL(String(t));if(e.protocol==="https:")return e.toString()}catch{}return""}document.addEventListener("alpine:init",()=>{Alpine.data("LinkChecker",()=>({urls:"",result:[],errorMessage:"",openIndex:[],state:"idle",toggleOpen(t){this.openIndex=this.openIndex.includes(t)?this.openIndex.filter(e=>e!==t):[...this.openIndex,t]},checkUrl(t){return t=c(t),h(t)},setRefUTMs(t){try{let e=new URL(t),s=e.searchParams;return s.set("utm_source","freshjuice.dev"),s.set("utm_medium","tool"),s.set("utm_campaign","link-checker"),e.search=s.toString(),e.toString()}catch{return t}},normalizeResult(t){let e=t.internal_links||t.inetrnal_links||[],s=t.external_links||t.extrnal_links||[],l=t.nofollow_links||[],n=t.non_http_links||{},r=o=>Array.isArray(o)?o:o?[o]:[],i=o=>o&&typeof o=="object"?o:{};return{internal_links:r(e),external_links:r(s),nofollow_links:r(l),non_http_links:i(n)}},formatInternalDisplay(t){try{let e=new URL(t);return`${e.pathname}${e.search}${e.hash}`||"/"}catch{return t}},async checkLinks(t){t.preventDefault(),this.result=[],this.errorMessage="";let e=new Set,s=this.urls.split(`
`).reduce((n,r)=>{let i=this.checkUrl(r);return i&&i.trim()!==""&&!e.has(i)&&(e.add(i),n.push(i)),n},[]);if(s.length===0){this.errorMessage="Please enter at least one URL.";return}a("Link Checker: start"),this.result=s.map(n=>({url:n,status:"loading",data:{internal_links:[],external_links:[],nofollow_links:[],non_http_links:{}}})),this.state="loading";let l=0;for(let n of s){try{let r=await fetch("https://api.freshjuice.dev/link-checker",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({targetUrl:n})});if(a(`Link Checker: ${n} \u2192 ${r.status}`),r.status!==200)this.result[l]={url:n,status:"error",data:{internal_links:[],external_links:[],nofollow_links:[],non_http_links:{}}};else{let i=await r.json();this.result[l]={url:n,status:"success",data:this.normalizeResult(i||{})}}}catch{this.result[l]={url:n,status:"error",data:{internal_links:[],external_links:[],nofollow_links:[],non_http_links:{}}}}l++}this.state="success",setTimeout(()=>{this.state="idle"},2e3)},init(){a("Link Checker initialized")}}))});})();
